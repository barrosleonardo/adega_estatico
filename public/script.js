document.addEventListener("DOMContentLoaded",function(){window.scrollToSection=function(e){const t=document.getElementById(e);if(t){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"menu_click",link_id:e}),t.scrollIntoView({behavior:"smooth"});const n=document.getElementById("mobile-menu");n&&n.classList.remove("active")}},window.toggleMobileMenu=function(){const e=document.getElementById("mobile-menu");e&&e.classList.toggle("active")},window.toggleFaq=function(e){const t=document.getElementById("faq-"+e);if(t){const n=t.classList.contains("active");document.querySelectorAll(".faq-content").forEach(t=>{t.id!=="faq-"+e&&t.classList.remove("active")}),n?t.classList.remove("active"):t.classList.add("active")}};const e=document.getElementById("vip-form");e&&e.addEventListener("submit",async function(e){e.preventDefault();const t=e.target.querySelector('button[type="submit"]'),n=document.getElementById("form-message"),a=grecaptcha.getResponse();if(0===a.length)return n.textContent="Por favor, marque a caixa 'Não sou um robô'.",void(n.style.color="var(--destructive)");const o={token:a,nome:document.getElementById("name").value,email:document.getElementById("email").value,whatsapp:document.getElementById("whatsapp").value,cidade_uf:document.getElementById("city").value,perfil:document.querySelector('input[name="perfil"]:checked').value,mensagem:document.getElementById("message").value,consentimento:document.getElementById("consent").checked};e.target.querySelectorAll('input[type="hidden"]').forEach(e=>{"_honeypot"!==e.name&&(o[e.name]=e.value)}),t.disabled=!0,n.textContent="Enviando...",n.style.color="var(--muted-foreground)";try{const t=await fetch("/submit-form",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),a=await t.json();if(!t.ok)throw new Error(a.message||"Falha no envio.");window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"generate_lead",form_location:"vip_signup"}),n.textContent="Obrigado! Seus dados foram enviados com sucesso.",n.style.color="green",e.target.reset(),grecaptcha.reset()}catch(e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"form_submission",event_category:"error",event_label:"vip-form-failure"}),n.textContent=e.message||"Ocorreu um erro ao enviar. Por favor, tente novamente.",n.style.color="var(--destructive)"}finally{t.disabled=!1}});const t=new IntersectionObserver(function(e,t){e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("visible"),t.unobserve(e.target))})},{root:null,rootMargin:"0px",threshold:.1});document.querySelectorAll(".fade-in").forEach(e=>{t.observe(e)});const n=new URLSearchParams(window.location.search),a=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","gclid"],o=document.getElementById("vip-form");if(o){a.forEach(e=>{const t=n.get(e);if(t){const n=document.createElement("input");n.type="hidden",n.name=e,n.value=t,o.appendChild(n)}});[{name:"page_url",value:window.location.href},{name:"referrer",value:document.referrer},{name:"user_agent",value:navigator.userAgent},{name:"lead_source",value:"site-estatico"},{name:"tag",value:"pre-lancamento"}].forEach(e=>{const t=document.createElement("input");t.type="hidden",t.name=e.name,t.value=e.value,o.appendChild(t)})}const r=document.getElementById("whatsapp");r&&r.addEventListener("input",function(e){let t=e.target.value.replace(/\D/g,"");t.length>11&&(t=t.substring(0,11)),t=t.replace(/^(\d{2})(\d)/g,"($1) $2"),t=t.length>10?t.replace(/(\d{5})(\d{4})$/,"$1-$2"):t.replace(/(\d{4})(\d{4})$/,"$1-$2"),e.target.value=t})});